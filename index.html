<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HertZ Labs</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
  <!-- Dynamic Header -->
  <div id="header"></div>

  <!-- Main Content Area -->
  <main id="main-content" class="container my-5">
    <!-- Home page will load here by default -->
  </main>

  <!-- Dynamic Footer -->
  <div id="footer"></div>

  <script>
    document.addEventListener("DOMContentLoaded", function() {
      const basePath = window.location.pathname.substring(0, window.location.pathname.lastIndexOf("/")+1);
  
      // Load header
      fetch(basePath + 'header.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('header').innerHTML = html;
          attachNavHandlers();
        });
  
      // Load footer
      fetch(basePath + 'footer.html')
        .then(res => res.text())
        .then(html => {
          document.getElementById('footer').innerHTML = html;
        });
  
      // Load home content
      loadContent(basePath + 'content/home.html');
  
      // Navigation handlers
      function attachNavHandlers() {
        document.querySelectorAll('#header .nav-link, #header .dropdown-item').forEach(link => {
          link.addEventListener('click', function(event) {
            const page = this.getAttribute('data-page');
            if (page) {
              event.preventDefault();
              loadContent(basePath + `content/${page}.html`);
            }
          });
        });
      }
  
      // Content loading function
      function loadContent(url) {
        console.log(`🔄 Loading content: ${url}`);
        
        fetch(url)
          .then(res => res.text())
          .then(html => {
            document.getElementById('main-content').innerHTML = html;
            
            // Execute scripts in loaded content
            const scripts = document.getElementById('main-content').querySelectorAll('script');
            scripts.forEach(oldScript => {
              const newScript = document.createElement('script');
              if (oldScript.src) {
                newScript.src = oldScript.src;
              } else {
                newScript.textContent = oldScript.textContent;
              }
              oldScript.remove();
              document.getElementById('main-content').appendChild(newScript);
            });
            
            console.log(`✅ Content loaded: ${url}`);
          })
          .catch(err => {
            console.error(`❌ Failed to load: ${url}`, err);
            document.getElementById('main-content').innerHTML = "<h2>Page not found</h2>";
          });
      }

      // Make loadContent available globally for navigation
      window.loadContent = loadContent;

      console.log('🏁 HertZ Labs loaded and ready!');
    });
  </script>
</body>
</html>
